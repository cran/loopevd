<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Julian O’Grady" />

<meta name="date" content="2025-06-23" />

<title>Introduction to loopevd</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to loopevd</h1>
<h4 class="author">Julian O’Grady</h4>
<h4 class="date">2025-06-23</h4>



<p>This vignette introduces the <code>loopevd</code> package, which
enables spatial application of extreme value analysis (EVA)
functions—such as those from the <code>evd</code> package—across gridded
datasets (e.g., NetCDF). These workflows are especially useful for
analysing climate extremes such as annual maximum temperature or sea
level across space and time.</p>
<p>You’ll learn how to: - Load and visualise gridded extreme value data.
- Compute gridded empirical recurrence intervals. - Fit Gumbel, GEV, and
mixed-climate extreme value distributions to gridded data. - Generate
spatial return level maps. - Optionally fit non-stationary models using
climate covariates (e.g., time (years)).</p>
<p>Advances in spatial analysis of multidimensional <a href="https://en.wikipedia.org/wiki/NetCDF">netCDF</a> datasets in R
allows the improved processing as gridded climate datasets
(e.g. temperature rainfall or wind speed) which include an extra
dimension, such as time. This package reformats the output of the
extreme value analysis functions in the <a href="https://CRAN.R-project.org/package=evd">evd</a> package for one
location to be analysed with the function of the <a href="https://github.com/rspatial/terra">terra</a> spatial package for
many gridded locations.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(loopevd)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(ncdf4)      </span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; terra 1.7.83</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt; Loading required package: sp</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="fu">library</span>(ozmaps)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="fu">library</span>(evd)</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#&gt; Warning: package &#39;zoo&#39; was built under R version 4.4.3</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;zoo&#39;</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:terra&#39;:</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="co">#&gt;     time&lt;-</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="co">#&gt;     as.Date, as.Date.numeric</span></span></code></pre></div>
<p>A colour palette for temperature and a coastline layer of Australia
for plotting can be defined by.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>cp <span class="ot">=</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;light yellow&quot;</span>,<span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;brown4&quot;</span>))</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>rwb <span class="ot">=</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="st">&quot;blue&quot;</span>))</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>coastsp <span class="ot">=</span> methods<span class="sc">::</span><span class="fu">as</span>(ozmaps<span class="sc">::</span><span class="fu">ozmap_data</span>(<span class="st">&quot;country&quot;</span>, <span class="at">quiet =</span><span class="cn">TRUE</span>),<span class="st">&quot;Spatial&quot;</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>coastp <span class="ot">=</span> <span class="fu">vect</span>(ozmaps<span class="sc">::</span><span class="fu">ozmap_data</span>(<span class="st">&quot;country&quot;</span>, <span class="at">quiet =</span><span class="cn">TRUE</span>))</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>coast <span class="ot">=</span> <span class="fu">as.lines</span>(coastp)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>coast.layer <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;sp.lines&quot;</span>,methods<span class="sc">::</span><span class="fu">as</span>(coast,<span class="st">&quot;Spatial&quot;</span>),<span class="at">col=</span><span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p>NetCDF Climate datasets can be easily read in with terra. Below a
aggregated 50km gridded dataset observations of annual max daily max
temperature from the <a href="https://portal.ga.gov.au/metadata/australian-gridded-climate-data-agcd-v1/maximum-temperature-tmax-mean-daily/agcd-v1-tmax-mean-r005-daily-1928-bom/42bf866f-f135-474f-8b84-1d8e206f51c4">AGCD</a>
dataset is read in from netcdf file provided within this package. At
each grid point, there is a single value (the annual max) for each year
from 1980 to 2019.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>r <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata/50km_AnnMax_agcd_v1_tmax_mean_r005_daily_1980-2019.nc&quot;</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                            ,<span class="at">package =</span> <span class="st">&quot;loopevd&quot;</span>))</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#r = terra::rast(&quot;../inst/extdata/50km_AnnMax_agcd_v1_tmax_mean_r005_daily_1980-2019.nc&quot;)</span></span></code></pre></div>
<p>Below is a simple and fast example of spatial gridded analysis using
the <code>terra::app()</code> function rapidly loops through grid cells
to apply the <code>base::sort()</code> function to extract the 2nd
highest value of the 40 year dataset. The second-highest value in a
40-year dataset approximates the empirical 20-year average recurrence
interval (ARI), having a 5% annual exceedance probability <a href="https://tonyladson.wordpress.com/2017/07/04/converting-between-ey-aep-and-ari/">(AEP)</a>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>secondHighest_r <span class="ot">=</span> <span class="fu">app</span>(r,<span class="cf">function</span>(x) <span class="fu">sort</span>(x, <span class="at">decreasing =</span><span class="cn">TRUE</span>)[<span class="dv">2</span>])</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>at<span class="ot">=</span><span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>,<span class="fu">seq</span>(<span class="fl">27.5</span>,<span class="dv">50</span>,<span class="fl">2.5</span>),<span class="cn">Inf</span>) <span class="co">#the Inf bookends add the hats/trinagles to the colour scale plot </span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>sp<span class="sc">::</span><span class="fu">spplot</span>(secondHighest_r,<span class="at">at=</span>at,<span class="at">col.regions =</span><span class="fu">c</span>(<span class="st">&quot;#FFFFFF&quot;</span>,<span class="fu">cp</span>(<span class="dv">9</span>),<span class="st">&quot;#000000&quot;</span>),<span class="at">main=</span><span class="st">&quot;2nd highest value in 40 year dataset&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="80%" style="display: block; margin: auto;" />
Each pixel in the resulting raster now holds the second-highest annual
maximum temperature across the 40-year period. This is a useful proxy
for the 20-year return level assuming stationarity.</p>
<p>The evd package provides methods for fitting different extreme value
distributions (EVDs) to data. It also including non-stationary fitting
and significance tests. Below we use the loopevd function raster_fevd to
fit Gumbel, Generalised Extreme Value (GEV) and mixed climate EVDs with
the <code>evd</code> functions of <code>fgumbel()</code>,
<code>fgev()</code> and <code>fgumbelx()</code>. Note: if your
installation of the terra package supports parallel processing,
<code>raster_fevd()</code> can allocate multiple cores via
<code>terra::app()</code>.</p>
<p>the <code>loopevd</code> function <code>raster_fevd()</code> returns
a spatRaster object with layers for each of the EVD parameters: location
(loc), scale, shape, and any covariate terms.</p>
<p>Below the loopevd function gev_rl can then be used to generate the
modelled 20 year ARI (5% AEP) fitted to all points from the gev_r
object. Note there are differences between the second-highest empirical
ARI (above) and the modelled ARI fitted to all data (below).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>gev_rl20 <span class="ot">=</span> <span class="fu">raster_qevd</span>(<span class="at">x =</span> gev_r,<span class="at">p =</span> <span class="dv">1</span><span class="fl">-.05</span>, <span class="at">evd_mod_str =</span> <span class="st">&quot;fgev&quot;</span>) <span class="co"># terra::app(x = gev_r,fun = qevd_vector,p = 1-.05, evd_mod_str = &quot;fgev&quot;)</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>at<span class="ot">=</span><span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>,<span class="fu">seq</span>(<span class="fl">27.5</span>,<span class="dv">50</span>,<span class="fl">2.5</span>),<span class="cn">Inf</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>cp <span class="ot">=</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;light yellow&quot;</span>,<span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;brown4&quot;</span>))</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#pdf(&quot;../plots/Empirical_20_year_ARI_daily_max_temp.pdf&quot;)</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>sp<span class="sc">::</span><span class="fu">spplot</span>(gev_rl20,<span class="at">at=</span>at,<span class="at">col.regions =</span><span class="fu">c</span>(<span class="st">&quot;#FFFFFF&quot;</span>,<span class="fu">cp</span>(<span class="dv">9</span>),<span class="st">&quot;#000000&quot;</span>),<span class="at">main=</span><span class="st">&quot;GEV 20 year ARI&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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lfhKH3lPiN7Wcl0OgAAEINlsAAFINBtAAJpm9jR5xqNPnof+5wOg2AJQ6xpimz1NAGpdQ2yzpwlArWuIbfY0Aah1DbHNnjZPeNRRVv8Lad+r8rQFoFgD0NEaYps9bQA6WkNss6cNQEdriG329DmoacJj/hoNAI0/e/oAVFlDbLOnb06APjYGoFkHoMoaYps9fW1PKr5pTj9hWIej3oqfSARQhAGosobYZk8fgCpriG329AGosobYZk8fgCpriG329LVAacNjXnm9a2jIEgAUcwCqrCG22dMHoMoaYps9fQCqrCG22fOoT055G/NvH+pP+whAsQcgAIkCEIBEAQhAogAEIO+ZeMr0s9A+8agAdIoBKIrZ8w1AUcyebwCKYjalACJhACJRACJRACJRACJRACJRACJRACJRDoA2SXKxSNPH1yf0qs0kzR7Q9vkif+345ZX6J8QaQgSgwLk9hO3uFtk/6fYTr3dBAIo4N0Cry7XCoxAFWEOIABS4PaD/NZYUFbfZXl8U9z4AIl0foOqts3MgAJGZG6BMDoDIzBkQJ9FkZg9IXcJvX665jCczh3ugVZI/g7i75YlE2uf2EBZ2DbHNphRAJAxAJApAJApA59DHjx/ND/ULWfgYDaBzCECznB1PAJrl7HgC0CxnR5X+Czr6FQpVPuYC6EwC0PxmRxWA5jc7qgA0v9lRBaD5zY4q85VwATSP2VEFoPnNjioAzW92VAFofrOjSoHReHzOBdCZBKD5zY4qAM1vdlQBaH6zowpA85sdXT6vvnQAOqMANK/Z0RUUUPeXgwagkQoJqHmnx9l+AEVcJ6CRdh9AEZc0vNf1qbBriGs2pZUNPtrrsTYfQBGXtLx//OE4a4hpNqVdgMbbegBFXNL2wYg7D6CIa73XARDZ1HbeM+bGAyjiWgCNuu8Airj6BieNnx13DbHMprTlyZ+Rdx1AEXe8wQmAyL4mQGNvelBAFLhxj2fzQR77B9JpBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSASBSAS9X88mCRADys+7wAAAABJRU5ErkJggg==" width="80%" style="display: block; margin: auto;" /></p>
<p>Importantly, the above plots assume the climate is stationary and the
AEP represent the period centered on the 40 years (1980 to 2019), where
an AEP at the start of the 40 year period may not have the same
probability at the end of the time period due to a changing climate.</p>
<p>The <code>evd</code> package allows the fitting of non-stationary
EVDs parameters (loc scale or shape) using a covariate such as a linear
trend of time (years), shown below.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>r_years <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">time</span>(r),<span class="st">&quot;%Y&quot;</span>))</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#https://psl.noaa.gov/data/climateindices/list/</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#dat = read.table(&quot;https://psl.noaa.gov/data/correlation/gmsst.data&quot;,skip=1,fill = TRUE,header = FALSE)</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#dat = read.table(&quot;https://psl.noaa.gov/data/correlation/soi.data&quot;,skip=1,fill = TRUE,header = FALSE)</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#n = dim(dat)[1]</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#dat = cbind(dat[,1][-n],dat[,8:13][-n,],dat[,2:7][-1,]) </span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#dat[dat == -99.99] = NA</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#CI = suppressWarnings(data.frame(year = dat[,1],yearMean = apply(dat[,-1],MARGIN = 1,FUN = function(x) mean(as.numeric(x),na.rm=TRUE))))</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#https://www.ipcc.ch/sr15/faq/faq-chapter-1/ </span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#CI = CI[CI$year &gt;= min(r_years) &amp; CI$year &lt;= max(r_years) &amp; !is.na(CI$year),]</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#CI$yearMeanRoll = zoo::rollmean(CI$yearMean,20,fill=NA)</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#nsloc = data.frame(yearMean = CI$yearMean) #climate index</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>nt <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">time</span>(r))</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>nsloc <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length.out =</span> nt)) <span class="co"># linear trend</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>nsloc  <span class="ot">=</span> <span class="fu">centredAndScaled</span>(<span class="fu">data.frame</span>(<span class="at">year =</span> r_years))</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>nsloctab <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">year =</span> r_years, <span class="at">year_cs =</span> nsloc[,<span class="dv">1</span>])</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="fu">plot</span>(r_years,nsloc[,<span class="dv">1</span>],<span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;Nonstationary Location covariate&quot;</span>)</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>zero_year <span class="ot">=</span> <span class="fu">approx</span>(nsloctab[,<span class="dv">2</span>],r_years,<span class="dv">0</span>)<span class="sc">$</span>y</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> zero_year)</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="fu">grid</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAAUVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmtv+QOgCQkGaQ2/+2ZgC225C2/7a2///T09PbkDrb////tmb/25D//7b//9v///+ebOMoAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAR3klEQVR4nO2dDXfbKhJA3TbZl7TZel/jOon+/w9dS7JlbH0AM4wE+N6z3uemCiPUexiEEOwaAAW7rU8AygaBQAUCgQoEAhUIBCoQCFQgEKhAIFCBQKACgUAFAoEKBAIVCAQqEAhUIBCoQCBQgUCgAoFABQKBCgQCFQgEKhAIVCAQqEAgUIFAoAKBQAUCgQoEAhUIBCoQCFQgEKhAIFCBQKACgUAFAoEKBAIVCAQqEAhUIBCoQCBQgUCgAoFABQKBCgQCFQgEKhAIVCAQqEAgUIFAoAKBQAUCgQoEAhUIBCoQCFQgEKhAIFCBQKACgUAFAoEKBAIVCAQqEAhUIBCoQCBQgUCgAoFAhSPQ5+vux9/9y3bnAgVyFej47ffhx9/PVwyCCAaBvt5empNAzeH7ny3PBwpjEOjz9Vcn0BGBIIJRC7Q/fQBCue8DHXa/NjwbKI7bu7Dd7tvv7c4FCoRxIFBx7UT/7NseOtEQw0ggbuMhhrNA+90AA4kQwagFUhYHlRAtUBoeok/+CJUUCNTdxZ9Q9YEe4do+RCUFAu1//D08NR/PqoHEUdx3TWmxrBRst2KsnjWD9bHiBWofwx/bh6mqRxkIZEIZAv1qPv75033kPELrXmElx53meIHah6ntnRgCeamukrtmVClBH6gdQdy/kML81JbCds7/y1PYqRf91N6JLdyE9bMVj0t3aghkQhkCeekE6lqotsOkLq5YaqvkrUDNxJ+8vxxGK9BZnblEV9u1naSSSl57zmn6QH5agc7jRHPP7ElhJlgEc61x78JEKeykxmUgeqETJGmBir/OE1Qh0FTecmIZtUCtYE/NpTutLK5YqqjkrEDN8l/MHtiOA/k5OfTt9+lGbO7YKq6tjyoqmVyg2RurKEhhJiQMNnR3JnrOTixBCksylxWBTEgXzNFmZtKP/FmYtxPtMDfxtYrW3UfBlfQkrvsDg0vUMsxjez/5yyf3zy7ouDUFmi+u0JZ+kYJTWEALJO4D2cxILPM6L1OeQIuDzpOxspmRWCPFVXJu0NnzK8FldxjNSKyR0ioZ3HMe/U7MgQEzEocbtflERwozQRcsTiBpCguZkfj15usgIZAJJQgUNCPx6+0ptLiKKaSSMT3n8S8LDvTOSGza6YjLfexCrq2OMiop6Dnf/XbaA4XFFdTSB1NECpP0nJ1YCGQIAo3iNO0tlqd7E1dczRRRSbFA7q9HHdiu8KJe4K6Ia6sl50qqes5uOaIDj5cZh+ni5t7SS8g4hel6zk4scR/IP9QTVVym11lHvgIp85YTK5sWqEbyrWQKgdySYg78eqMPFEh2lbyZprqVQEZ3YVm29EpyS2HuNNVG7Q/jQOZkJtBNsyPsOY9iSQT6eNYnsexadwsyq2S6vDUqNOrA/mUv5V4ZmV1bGzKrZCYCXV4sZH0gL3mksFRDhtOxZBPKWnSvhyGQCRPBEgwZLsXKpgWqkRwqaZK3RuVHHUgfKJQcKpmhQDZ3YVu39BbkkMLsBGIcyJwNBbLqOY9iZSNQjWxXSbOe82Sk2APb7XbnV/5ZLoV349f4hL3TnuoTK1C/XbPykRgpzIR3J7B1AyhNYYwDBYNADuNxILZ78rF6Jb2rihmEjD+wHwH6eFZteYlARvGSPWyPiBl7IONAgaycwnZdsNWslaawNCCQSbgHFqhGVq7kKl3n6aApD9ykuDxZqRtrP+i8FD35gcLiSGGKIINB7yv6k1kKQyBFjOFyrnkVMxOoRtao5CYdn1H8qAO7F8PYNz4ABJo8cM9WB4EYprCZnnMJKWx2B6coEEhd8tR0jTIEMtmtp0bMKrl13nKQPExlgalAEGjyQN/6mbK4pLDYgqf+7cpIYTHbPXmLuz2dlShUIP+YcwkCBdD3s49LkmXR/FpjMHa2zkTnCOwE6l48nO1xZ1J9W9JWMqOOj4PJfCC2/e5Jm8JCBCoihfnfTG0FOm8HNTdzGoFkpVUgUMC78ZIWqEaSVHLb2Rpe5AOJC29l9DdqT83CsHV2F8KCFJXMsufsYNICNZ1Dp17S/OuHpLCIIsL/lUpIYUarcyDQfBGVCcQaiaEkqGSe9+4O1hPK5l4/zPiSpENeycx7zg4rz0jMZHGF98xj7ZwFEqKu1fuK13GItaZA88XRB7r7PdEVz74PdLotN3qYWiPSSmbf8XEwSmHeedNlXB0lCDR1YLvld8vS8i6Hy/jP7EAQKWzqePXiGtmnsOYq0MLyLpexxoaHqTGxHG2kY875C7Qf7qMW1rhzJnEEP0ytkbhKlpS4rshboAUkLVCNIJDkwJbhOQd9oLhtTLUC5Z/Cmuuk6KXb+Msxsw9cEWg4KOWgcxEC7X/8PTxdJoxJKa2lFhFSydyna/iQzAd6aY6nloXNVrwEVLLMjo+DbELZxz9/uk/CuA+awhILVEIKa2+x2jsxBPKCQA7XA9sRxP0LKczPfCXLma7hQ3Ibv39q77J0i7yUfM2Cma1k6T1nh5XnA80X90gpzK7nXEQKSwICPbBAiu2epoqrl7lKFn/v7iAbSGzSb/dUI3eVrKfn7CAbB2phuycvtylsjZ5zCSnMaLun6gVaJW+VIBDbPQWzG/+hunpLOtG8WBhIl7TcaaoV1pvbeEN27f/eG8cga3+KSGFJeBCBdo2zhdcKY85lCEQKC2RXa95yEAhkszpHjSDQ1IFh6wNFx60qhZ2T1W0faA1KSGGqgcRHXFxhzbqWsLiCUQtUEUPeqrmSF+gDpQeBPAeyb/wytwJVVLGpWIwDJWP8sB2BHKwFKp6Jh+31VXKMXKDE0zlKZ2rEp7pKTpCNQKW39LMClV4xTywESgQCeSCFTbO0qlg1lVwAgXQ42owfttdSySWyEajMln75YSkpzKE/cFjjlz1TOxCIcSAVAQJVDgJJCHzDq+xKhpGNQCW19BODzrPHFVUxQSwEiid4miECOcQIVPm+8XECVY6dQPXuG49ADpIprTvfsgp17hsfvzYCKczBOfCwuM9BU+m+8aE957tfyb9iuljCFLbsUI37xgfnrdHv1I24D3RY6CLXuG88Ak0jE6i9wfrVfL3Nv5hR3b7xYoFyr5gylkCgtn3pzVE8Ty1FINWqYgjk4NyFKV/IiIu7LYKe891v1068QM5mYAGUvW+8JG+Nfr1uJC2Q6o3CubhZtvQpBMqyYuliCfpAuplko+JuTmclEChZLNFItHxCWSaLK/g+w/ntzp8MzinfT6RAQRS9b7yu53xXUO3YTOcoet94Zd66LymfipnEEo4DLaewsveNR6CYWAKB/Humlr1vfGKBKkfSifbumVrkvvEGO1nkV8n0yMaBfHumFrhvfLKe812Zm1fMOJZsJNq7Z2px+8any1v3hSJQc3dglXum2glUOZLb+NA9U5eemuV2bRFIiM04UE+UQNu09LZ7wJHCHKoUyKLn7IBADtcDvY8prgdmnsJM8tao/LqRDCSGPkVFILOS80E2kGgQd4uWfhWBSGHN7YEVTCjbve+uZ2HYTCCQgzOQqNrv+764DXC0sd0DjhQ2eeBRt0tGZNz0WCeu+0h1s/KMxPm46zW+u8bZhtI6EinsgvUgLQKl4IEFMsd20Hk65BpBNkYiUJGb7hoPOs/GrB1RJ9piwznjxve257xSS08Kc7iZD9RS1qa7CGQUSz6QWNZWB+vdu4+C1k02LZANG/Sc3egrx9uCuvtAcz1nUliyWNnchVlUfTZvIVCyWCuPA23xbjzvtht/1hTIqrjbst094LbsidAHkhwoLC5d4+s+bJ+KlDSY90xIYWf6Az9fX3J/mHrT7MyMOSNQsljZtECJS84ie2RxEsYIBhJ/9vdfuQ4kItCqyAWaWz5TGFfb+EYNGZLCksWKFWh/3TNVNbc+tUBxD9sRKFkseQukw6RLlVvKyO18LKikE41AWyEQyL/EnSSurvGNFIgUliyWQCD/EndRxd2cTmwpwoftCJQslmQ+kHeJu5jiNGwxTTWG/M4oPbIJZb4l7hLG9ZaR8b9SxqeWDNmEMu8Sd/FxBY2vXCBSWLJYgj6QzRJ3CJSCIgQKXuIusLj433Wna+ScJnI+t1SYjAP1K8AcjfbKcKdrZNhzdsj65BJh8jC1E6hLcbNrwchTWIquMyksWSyTh6mSbb8RKAX5CxT0MLUV6DzQmH6vjOxv3q8UcZJKTB6mSlogb/xN3/CSUcZZ6jDqRLct1FOzsKBibApLO+hMCksWS/Qw9aU5LGyDcT6ofXNsdq+VWIES5y0EShZL9jD14/mpHQ1SEOlCQR0fh9LOV4LsWVi7TOKqc6IRKFdkArVrjYfNiZ47KiyFWfWcSWHJYklS2NPn64+/n69pU9hU1c2mayBQsliyGYnffmtXiw6JW2becij41INZeU60YHGF3eaLB/BZ/qwp0HxxEydi1wKRwpLFErRAwds9hRV3czrdX9mPOSNQsliSTrTXnGH9hXnN5uPmPtE5gqJPPhDJbbz/ldSvN59ks3GL7zk71FGLZWTjQF68N2mzKWwVgUhhyWLFCxR2A+/b0geBTChBIJvtnkqcreGlkmosIklhBiuUVdRzdqilHktYDiSGb7q7a9bagamHFJYsFgIZgkAOzoGhC41HCRRzLqVQXYUmEHWiA7c6iNg3vqKes0N9NRojuY0P3WwlQqDrTtyrQApLFks+kJh4RmKN1xmBHAQtUFBxNfMIlbTsAyWJWzKPUEnLu7CouDW29KQwh9QTyu55H/3EkDWD1V6xjQRavfzNglEx9/CAqWLrnE45wajY9OF73VYH3vJNyfg6lxNMJdCpJUowp2O+fGMyvs7lBNMIdEycv+7Ltybj61xOMIVAB8/SHBK4zqUFEwv09Za4+3NX/gpkfJ3LCSYVKH3357b8Ncj4OpcTTCiQQffnpvxVyPg6lxNMJtBhp1tUAR4V64FEqJxHeLIMhiAQqEAgUIFAoAKBQAUCgQoEAhUIBCoQCFQgEKhAIFCRXqDzxvOHyztmpy/9RJGj+q2zoGD9l9TBukWQX25KHn8xDDZU1b5ik9FnSS7Q52v3NHZ/itxtj3no9hc7fTm2XxIbdB9s+JI62NfbqbBuysJQ8viLYbChqvYVm4w+T2qBjv3j/H7R4MOPv/3anfun87v3ut3IfMGcqImD9VvFHr7/GUoefzEMNlR1hYpNRV8gsUDH3Uu3vEcv7vGye4t7XobBhi8GwZq7ksdf0sa6rcalqitUbO4nM6TvA7n/pqfUdUlhH//5fflLs2DDF5tg7WL+Q8njL2lj3QRrLv9ZoWJzP5nBSKCzvV3fp++JDa2DYbDhi1GwU9dy3NrZxLoN1v3gprG1jTXxkzmMBDp3Z3f9Logfz6Gnow12/mIS7HjpWK4h0G2w7idmAk3EGv1kFiuBmv2p1/fvT6fPYJfChmDXqAbB+vWTVkphd8Gay39WqNh09FnMBGr5+OePcb/2NtjwxSDYoR8aWacTfR+s/YNVJ3ocayr6LKYCHdqdxH/1P7O4jb8PNnxJH+yyctsat/HjYC1Hk9v4iViT0WcxEqjbu7drfS59IJOBxLtg16ipg3U16CPaDyROBGuG7GJesenos1i1QO2LQn3s/WVg/GDwKOMu2DVq4mCH/pWntsjxY5PUFZsKNjS25hWbjj4LD1NBBQKBCgQCFQgEKhAIVCAQqEAgUIFAoAKBQAUCgQoEAhUIBCoQCFQgEKhAIFCBQKACgUAFAoEKBAIVCAQqEAhUIBCoQCBQgUCgAoFABQKBCgQCFQjk5bw+6scz28pOgEB++vWW0i+jWQUIFEC7RE2/hDDcg0ABtEvm9A3Q4bJWzb5ff//z538ffJtrBAph//3ffg3zywJM3Upe3ZJWl3XRHhUECuHjedeK0qex4/c/n+2Cnu3qfSQ2BAqiXzewX++tX/axXf+6FejXtie2OQgUxGUN/J5fbV/o+/+eEQiBArlbdLtrhD4QqEGgQI7nNTzPuvSrxpPCGgQK5Nz2HLqFi/tV0z9fTzf0CIRAQVySVzsO1C/mvvv2+2QSAiEQqEAgUIFAoAKBQAUCgQoEAhUIBCoQCFQgEKhAIFCBQKACgUAFAoEKBAIVCAQqEAhUIBCoQCBQgUCgAoFABQKBCgQCFQgEKhAIVPwfQrf2jDKM11wAAAAASUVORK5CYII=" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#print(&quot;gridded non stationary gumbel fit:&quot;)</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">system.time</span>(gumbelns_r <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">raster_fevd</span>(r,<span class="st">&quot;fgumbel&quot;</span>,<span class="at">nsloc =</span> nsloc,<span class="at">seed=</span><span class="dv">1</span>)))</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt;    user  system elapsed </span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt;    1.31    0.00    7.69</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#print(&quot;gridded non stationary gev fit:&quot;)</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="fu">system.time</span>(gevns_r <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">raster_fevd</span>(r,<span class="st">&quot;fgev&quot;</span>,<span class="at">nsloc =</span> nsloc,<span class="at">ntries =</span> <span class="dv">3</span>,<span class="at">seed=</span><span class="dv">1</span>)))</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; Error in fgev.norm(x = x, start = start, ..., nsloc = nsloc, std.err = std.err,  : </span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt;   observed information matrix is singular; use std.err = FALSE</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt;    user  system elapsed </span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt;    3.78    0.00   12.36</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>AICs_r <span class="ot">=</span> <span class="fu">c</span>(gumbel_r<span class="sc">$</span>AIC,gev_r<span class="sc">$</span>AIC,gumbelns_r<span class="sc">$</span>AIC,gevns_r<span class="sc">$</span>AIC,gumbelx_r<span class="sc">$</span>AIC) </span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>best <span class="ot">=</span> <span class="fu">app</span>(AICs_r,which.min,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">plot</span>(best,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;grey&quot;</span>,<span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;green&quot;</span>),<span class="at">plg=</span><span class="fu">list</span>(<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;gumbel&quot;</span>, <span class="st">&quot;gev&quot;</span>, <span class="st">&quot;gumbel_ns&quot;</span>,<span class="st">&quot;gev_ns&quot;</span>,<span class="st">&quot;gumbelx&quot;</span>)),<span class="at">main =</span> <span class="st">&quot;Which EVD is best (lowest AIC)&quot;</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">lines</span>(coastp)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAA51BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrYA/wA6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kJA6kLY6kNtmAABmADpmAGZmOgBmOjpmOpBmZjpmZmZmkJBmkLZmkNtmtttmtv+QOgCQOjqQOmaQZgCQZjqQkDqQkGaQtpCQttuQtv+Q27aQ29uQ2/+2ZgC2Zjq2ZpC225C227a229u22/+2/7a2//++vr7bkDrbkGbbtmbbtpDb25Db27bb2//b/9vb////AAD/tmb/25D/27b/29v//wD//7b//9v////a3dVhAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAdHklEQVR4nO2dC3vcNnaGISdOFW3STTdbycle2kT2tt1su1LaJrGnadrYo9QS/v/vKXEjQRAg7iRIft/zaGZEcg4PD97BnSChEJQhsrYD0LYFgKAsASAoSwAIyhIAgrIEgKAsASAoSwAIyhIAgrIEgKAsASAoSwAIyhIAgrIEgKAsrQzQ4w15/pbShytycUfp00vy7PWJf+Tq/md7B2n71Aal5z+/VDs7a8/fyj0Xv/meuqxx3Xen9Dj59O/9EY83F3d2O35pZig9E3leZe3px087d3/9Pfff61I7WhkgjgwPJ7nmOF3SVIAYMtdq4/Ww5+LWZY3LD9AvXw5HnDoTiQDpZthpCbnVvHr8Urp7zTddx9tfSWsXYQIJFs5LnnVcTyGZHD3aMAAkczMJ5bDHbY7JD5B2BE/aRIBGJ+p85VesAOpelW4FpvEnWEdrA3QmIkl4jn5m4esg+eu3hHx4N+QZLHf/4GtK9X1CJz1V7gUrHYaX/Z7/+VImVG/tvz4dFWxduv7n7wgRG5464xef88TrD2Nwq7Oc2RmUV//dfe2Df3zLjnjOX1na80vwmeGG/iD+E9Y63D/8S5dLvWS/BHYFKttsXmsDxFO7q1n8mSXNSbwIdeGVSXXfZ+7aPqERQGdRhp3kr1jsUfmSllQjC/eaSZ4vdEn5mmqH6Sl/0rw6qZxPYMW+ey3yGa8ZztxPV9xbbk2W5N1/rz7/X+7HZsqwtQHi8TuTZ//BwnkvU/j596IeI5Kq4+Lv3/5yI8sltU9oKKhuedxF+j57raHVf+DWWDXrLf1xsHDPTf7I86ku9b8X5ah+2FD2dBYuFYi8pi5c4RlG99Lt5Ef4zAhCJIe9V3pU7rdThq0NEI/riVyyyIv0OSkYFEAi8qfffDfaJzQCSJQiD1cyH+oBkpUgbq3b++F34/Pz3TLnUN/UDxtSXqSz7hV/436feAbDWPKakUXhSbU8uVejLCegadiKVgeoy1++fsnrzs9+uBHFFIsrTyuVvfc/R22f2qADdCb898+JcAAkaqu86iIk04odxTIRWe3WDxtSU6TzyCtZ6j5/e08+6pr4kpp5MzKH0ayZAM01JBrT6gB1sfttF3n2o/zmioXNAlCfvVsA0n+qrAz74UalrBWgrjUtEvdf5XfuBxDOWrtNO8wKkPKBV5o73//thv8O7nmB7DFDe8RE+2tahAGgcPEaZxfa7v1vZeUlKgca5fVdGfZHWb1Re/r6ad96+uXPn4q0k1/RcyCt8dMf5s+BOof+7oplPx/dqCrRnJlRvmlWonlzEABFSPYB8dxetG7GAMnIn3/9Fz9A/Kcttsg9rGE8bsbzj//Uf+9eVZ94HWiUD8jDrADpdSBxDSLrETjNm9E6fdQ1jpvxAChGJ9K3vuW7AVCXLp/zusvtXB1IdaooXqYdibLB1zXpWMky5ECszaRaYRdf019ujMOG1NQr0VorTPSkX/LMVHQ7zJsRHVUyc7R1JKISHaPzUAPm7xOAVFfN5WwlWuU7coTAOZTx7ZgqWz8Q26cddibauFUPkNYPJHI+Xhpxx3xmTpqPt+ZQxufCKTTjgyV6b/i7bD6ZAIme6K9oAEBdSvZ1Z5F0k8HUYdCSa9QT/cs/X6mPw2GsX/nD76VRVe2lsif6K2Va1P8FGfNmhloZy8V+Hg+mfifNoSNxlzovUzd5uNpMFQgARanLGpYYpDpvpwQrDtB5XMPYm05GA6uO7rdTgpUG6Okl/4U+fLaZX1CcHm8WaB4deULZ4xevtTdo/6qUA30CgA6i0nUgMcyz2zoQZAqtMChLAAjKUkWACFRX9ZIuQqVbYWIYaBgLbOMqF9HSKdpGaEt78fhiXH9u4yoXEQAqovO4F76Nq9yl2ghtbS/auMpdqo3Q1vDirI0XtXGViwhFWCkdFqBlEWojtAComJZuWrcRWtSBigkAbdF+rrxJHn4BhDOU506M2gjtwQAaJbDsz513MQqgRa+3jdAeDiBCVXU3aEAgIktZEaAVhzeOBdAQZ0K1j3NfiDCuvS6hZIDkpC2pzLlbhwNIS2ct6o7IR/2iN5MDAaBk9dkNUaktQHKQElUkEM3wIgJAi6snZQi0qhNZPI2sUZDR2wLyAvRwRf7m5S0DpPt7evkPV+SS31X99PKPak3TZ68BUIT6Wg/RNuk7xgfTqAyluRzo8YYtJjAAxFaRef724Vd34uMty4hO3QYAFKtxW37YqpAZMqWITEgduVxLyAcQmxfRcdIDdEvlHy/C7i/ZjscXdwAoWlqgxyHX6tSx7WLtyFYAOvH7+F0AnS75/Q8XACheQ6DJqATr60daeoQS1B32vlNMnpWrzBzoWpIDgKJFzICPoy+LMioBCruCdQGyStaB+NuzMUBsVUbOUUcPAIqTLYntxZWqFAVZpQNASyHkPU1XRn30gi+8/dsvxgD1rbCLO+RAkYoCiIY2q4ieA7UCEJ1OUV/Hi5btR0qC8mbQe01vDIVnJ8poVL0pU76zdA12eq6+TMMBAereigNEdYAWumjvWU5L3GN+NIDEWwRAgXYJ1XOgRa66jdAeCqA+ZcsDRDWAFrrqNkJ7LIDUh70BFN3vWcWLTdqPElGtbQdAumjUHGdleMm+IB2gd1IAqK5iAIr6QQOgrdqPEYnKgaI4aBIgMZ1DzNpg3YXjeUDlvaiihgCS6RoMUER/DmkRIDmUIWZt/MzGLWosfXokgMSbUVH25ECBHdHsRftyEwBpg6mPL+5Ol/RUY/HgHQLkygBSAArMTZoESE3nkLM2Pvv5VY1exd0B5OzKU1tCAXKMkNlPyl7WBMgznYPp22+qLN69K4CIGoqyjpjK9/AciKpZ9/4TsxcdoCUuO3A6h5y1Qc91lr/fH0D9HB9zn/wQDJD4UuBgKh0BtEgWFDqdQz4GqdLi74WvlHl5ItqzQpYDqJ+KSvtBd30vfw0hR89Egge2bADVbo3tcjpHBxBb3GVoMC4KkD7VeZx3kHiAeksh52YvrQG0yekcHUCssThklwsBRMaZzmRaTjRACfeEjQvA+vM6vMa3OJ3j8eb5T191b79fNgcyGyHTPhyxJQKguPOzlxFAC9wm1kYXW3Ev2NP2WOZZy75VkhdCeV+IkIHBqLPYIdWbEu32CCB28o871Z6duFOAFrZvnGYCUJ8rETVtOQSg2GSfDGX0AFUkyNcP5BTujbecRp7HBEj1JsvgRuRA8WWYHaB6BOkAqXJ5VwCF/yRKnEl8mgIkD4gtwhLKMAdA1QjaJUCrPCuDqB5oQiRAamRoqBa9iwFIYBDlAhXwagDHFSsJ8gIUuzrHwyf/wrefY1pvpa9u6WdlaGlkBWhIV3ZIBEBxGccsQCvlQNGrczxcXbOOI5aE5+DHRhe/uGWflUHqARRzcwU/sDWAolfnYI3n7j8GXpIXVVS9CCNkWDVqChDNACjC+XmAKly14Z0VoOjVOeSRvB4SzFCNq1t0pfrhBFOAODQ5AIUCsMUcaLo6hwKIfTd4CGQHAOlJb5EHmjmFEqQVlPKEOki1YuDrB4penUMCFDeGtn2AeIO9EkDjIVq3D2sDZFfs6hwqB1q1Fba0/doABY2pNwoQ3eB0jgXtE/EnegzrAUQDegI9AFUKgs/qJqdzLGhf/raHFpgDJJ2IgHlAetLLz95caAyQrjUBCp7OwZtjqVM/Ng3QUD7UBYh6cqFGAVpEmwSI9NNX+2pGbYAMgsaX5QFoxTpQfW0ZIFWCLQKQ0eGkX5feXWkFCDlQW/ZVBjTeVBsgbca1JTuaL8Lq/IzGlx/WZVXTi63Yl7/p/vYLCxUugALg0QGaSjpADH+cADGFzrKIjoP2UV0BAAqwqKqlqu6zGECOsY3ROIYdoDc1sgYAlGZwmOa3PEBUntqsAQUAVOGXpH20AuRc3iVp4o/fiyoqbX+o0vZZwsIAmXWgIICqFOXaRxtA7uVdkib++L2oouIAiSF1dc+ohwQbRMZmW5K760BEDHmPc6AZeJS1GvVoH0Du5V2SJv74vaiiwvbVzHieDdDVABpfYAhANSqD2kcbQO7lXZIm/vi9qKLSANEeoLlJznUBGjXDggEqXxvUPk6KWTq3vEvSxB+/F1VUDaDZ2ywqA6RVxUgoQBWaE5797uVdkib+JHqRqwpFmJ7ECQC5qAmDSNtNFUceJC2ZQ5lY+A5wLu+SNPEn1YvG7LcCEDVuRmsRIIr5QFZ7jQA0qFGAMB/Iao8AIBUK3wGT+UBZE39SvWjNPgAaItGCtgaQzIFYQhmLHb5xAOJgLJAjkyX1NcfXzc397TYVCAJACdbUwDcAypjO0fLiCnXtD63mTQJUoU9MffxYCgAF2AJAo3DwjwAo0JaNDB0gvZ5bDCCbpcCvMH9WAyh4eZcTu7/wKm0d8g0BZI4abA6gwuNhPoAilne5v6T3ievYbwkgunWAysoHUMTyLl2elDovaDsATWaObg2gGgPL6qMNoJjlXc7J0zo2DBCTXok2+/r8AM31FBoUKBJmrNm40i1PbgcqERD5MSEH0pd3eXzxTWpVujRAZx6liwrrRG8fIH0AtlRA5Ef9JErhy7s8vbzm+VWmFyUkW4gVnpVhn3q8MYCKzisLnc7hX97lnudVlz57aV7ESU46Kf+sjOnMiW0CVDAX2uV0DpUDfVIYIGVmBwAVC8o+p3OIGQNl60Aq+I60NQEy5EnyQIh0GiIgslh+P6x/nhkW3wFbfFpPBftDsAHQODAFbOSrQg50WaIOpKqceqh3A9D7IhWhXQLE6kDsnkcGkAhZolu2L+8IIEpH9walxSjv64VUoxX2+MUPmTnQcB+MmSLhAL17N65Ae5LeTHLPSWesuQ43gNKWSE/TLgF64nc/Pv4upxU2CuuOAaKZXdO7BKirA7F2/DnyaT3awgVGTHcNUF45tk+AUuwT7UZPc9++AcrhZ8cARa5Uz6Op3eg5EgByxy39qwW1IkB6334fVPVJn6OhpQyxyAHQDCzKmivJI+SAx2OZ+SceapgR5qMD5Fpw8EgAZYV/vwCF2bcPTx8NoIylg44OkNht7j8YQDnzOwBQv9dIBdeotwbQG0PqKclM02QdWcygJRwiG1SKHDLMcg2+Eyc+tEtpVYAIAMqoSAOgft+hAcocb15bKwI0Hq84MECoRCfYZ+GjluhHyITIUXs2D6kCzZwc31b+9FNXSoV2Wa0DEBkvkwCAaEJz7JgAjYYsABBBP1CcfTJaMhkAAaBI++Ihceo/AKQASqlIHxMgPvDuCHEiQCYlnsPJWKsApCQdIElDGscEiNqecHF4gJRyQruSlgVIzNcAQFOAEua3HhAgAoCsAL1TkQFA8/bZP5GUlFUgQIq1PIACMBwcIO+iC7EjAkQAkAMgWRFKDu1qWrwOVB2SOQGg4gJAAChLAAgAZelYADGRqQKSOhKgCEvKCQl3amjXEgBqC6Dk0K4lANQWQMiB5uyv3oxnahygcISOCBCdBeiNoXRIXN+eST9Pstt4iyQm4AyT+yyDQ7ualgSIfwZAswBFEASAAJAFoPCpQYcDiACgEICCB1WPB5D1USkzAAWA5NjtqiFbasyBlekMgAIPG1XrI0O7ogp7wdZIPBEyPHcBAKUAFJQsewWILe5ifVYGAAJAXnUAna4d60QDoHCAQtJlnwDdPP/pq+7t97an9YwSCAABIKseri7u2GM+bPbZPypWRpKzu8QTAbIcwjaZya3+Z/vMBJsHyHaY6YgHHA88+lmGf0XMnCm0U4Bc9gkFQDEAUe8ynPsEyPmsDAAUCRD19SvuEiD3szIAUCxA9IgAuZ+VIcZ5BoAsECUApL5m2aQvGaTDo8PlAUixZkDk8MMDiIsrtxnP4OouAXI/K0NWCQFQOEBidONYAPmelQGAYgCaH5vfJ0AO++r5TQAoFqD1ki5MNbywrFTfF+f8f0c8VfJ+LOUBSFlwpKkLFMf2gKTXAfKAnQkSAJrY7wFSLTEABIBcsgJE6PBYHgAEgGLti+ILAEUCNEfQsQAS7ACgWIBmEuhwABEfQCZEevp6EshyiA2eAHAc+2wYxjUWddcdV6VfmrqK9ZIuTMtNaSUyDwJAACjJPulbYgAIAKXYJ/1z0gEQAEqxT8zii8kIvavqa4TbtGLBMZacOFlgCgTIcUWuo9dLujAtCRA1iy8AlEPQAQGiyIGicyAAZPwHgABQhn0CgGIBciJ0UICYVFJHAmRE3AaO9m8eIIkQRbbIPHonHqMRFtqVtDBAw3QOABQGkHtKIgACQH6AZrKgYwLUN+UBUCBAKMKmG8w0NsjQabFApDNmArQMORaAyHSYf4aKAHiUFdSBLBsAEABKtg+AIgFCJXq6AQABoGT7JkDsXUZej59eG7Uk1BxEjqR2JH85gALgiQBoDNEaSRemxQFSwxkACAAl2icACADl2B+WtwBAACjFPgACQFn2eUSMWNoIMbt0HRDpAFmS2LRkSfpEgCxwBwAUIQDksA+AAFCWfQAEgPLsEwAEgLLsTxYdt8Fjgch2iAMFGzxK5te0b+rJbwHG/N9htAxATEfriT7z+F3Y14nWTwuAAgFyptAuAWKrtFLHszLGpwVAAMgiuUC09VkZ4/MCIABkkcqBpqu0mqcFQADIpocrFr/IOpCWjjPwqETyMGZrrM2Y0AGyJaAGi/rKDEDqlv5cbAaLRwMo0D4ACtERATqTi2+uSL9MNADKkfBvqaRLU+k60Ks7ttQ4b4WJhHGdFgD5xf1bKukSVb4V9vSn1yGtMPZiAciEyBJSH0AaFQ4rNogiAFIQWY5WJ05FZurmwQCSrTD7Ewsn5wVA8zogQJQ/rPDsbYUBoBDN8rNTgELtA6AAHRUg20r1k/OquzMsDKk1oj3Jbm52HBYI0BxElm8GHJovADRjHwD5NdeIB0AEAPl0VIDC7AMgr94ctAgLs08IAPKfDAD5dmkp4Up2CxE2KsaR78nwHfNm6FrWaZ45i+fkAQrEr7uAN0mhXVAACABlaUWAhr6gaZICIHEiADQLkGrKT5O0EkD9kjHvtwEQAUCz9o2+ID3pbYkWB5BKKKrmBfSSW4QPJjw6QGl0FJD0wx+99XUAgBx9KWSogwGgdO0eoJkJWZNnl7UG0Fw3IgCaJqBK+nIAsb6dOeeG7p8WAZrnBwDR/lng8QCpKKt3tm1q3XtxRB1H+hVDzJM6kjiA4gxJgDJCu5j2BdCATAA9uh+iUm07qSOJAZDU6nWgggAR9VjfKHqkK+w7tpM6khgASe0IoMxLsXQ6rguQ71cAgEoWYQmZztSZOYDIdFddgObr/77QLqZ1e6LHAJmEWBLMFm0aWeOZ8ZWMesZHJzFKOMdhhRR0QQCIGEVYMkBF8KHDU6XtSbogQEG1OABk1oGSAEqpMbvcMcbmdC0NUIi7hS47T1sHiPAirJSzzhyImFXsmgAF/iQAkAmQDpEZVEcFurD7hNhyIVXYsiNqQTMGKMzZsteeqG0DVNp7Yi3GuKMyVQGQoZYq0esDRK3F2MIAdWVlmKflLz5Bq89IbA0gS1NeK8HqA8TrWqGONqC1AOofZ50DULH2l+HxBCDpMQVAE60EkBivehcmp+3yzg/PKO3pkZ16lrHWSgQF+1r86lO0Wg7EXsIBEsCNiamR/5D+RcsR1MkAkEWr5UDs1YvOaCKzPtiuZvDUc7rnZ7KpMj8AKMh+CECidjQaU+zTs6rffXbTN4gW6wMCQIH2++2OPIfWhmROCqDeg6U6EqMuepcAscURT4Q8VyvczQAk98wAVNa1GCmA9A3Dc/KqAhTlZAMqDxBb3MX7rAzaTxt0ArReBqQA0ifIqmGOygDFXPNeATpdhzwrg+9TwwauavNKktNbNQ84QAs05aMuep8A3Tz/6auQVVpHe8mwskoNp2Ilc8DRJlmKVQSId1gcHiD2sIyLO75Ua5D9vjdaA2jNzEdqUoQqgAo+RQUAlbCv2lsaQE3ExShDFU+1AUIRFvqsDM0B0SnIgve+6PzCPGkE6SVabYCiXCx+0Skq7EXoszJGLoxU1p8sDYMYw9BvVYDiLr+NUJVvhYU9K8PuS1P8SBHtl1CzEh1d+WsjVqVzoNBnZWxHerJWBijSscIXmqbSXoQ+K2OTstz9XBCg2Oy3jdCu3ArblGR/dDWAYt2pcpGxquFF0Er125E2nWToHyoLD5toGV3/ayO0AGhe/XyyoSpUYVCVAxTtWsnrTBYAmpVGjVaZLj4mlpIBNRJa1IHmRdRsWmNreYASXGtBAMgjy8gqLd6hCIBWs7+WytaD2LOek1xYXwAoTQBICgAlqmhFGgCtZn81ASAhAJSoogAlTUNoI7QAKFEASAgApansHRoAaDX7a6lsKwwArWZ/Lc0s6Mr0xqIZgOafLOdyocJlxQsApakwQAlDYY2EFgAlqjRAyIHWsb+eZh8zD4C2Yn9FFQSIoA60lv01FdASo/IQBpC8+19t1g0lRamN0AKgDPn7gtTUIQtA2TfDtRFaAJQh/10ahNgBKnEHZRuhBUA54tnHHD5U3k5vAFQkKm2EFgDlapKZ9MWXNplRWwEptcozPXERK7kCQPky1ozV6j9qXdkRQKVC0kZoAVAB6beN6StMDzXl0Rpspc5ayE6eAFAJ2W4Z024o03OgcgFpI7QAqKyGVYWmm6ilwpRzqmKWcgSASsu2xGxfGSoZjjZCC4CKywpKheWz2ggtAFpGFZZfayO0AGgxAaAQnfkvbacLTGWqcCzaCG1hL+QSd/5HHUDZaiO0hb2Qq2umLbIJRamN0FbKgT4BQE6Vqgq1EdrSXjxcoQ7EVX/F4jZCi1ZYHfmaXAXi0kZoa3jx9KrPgBq5yuVlrmlm7saEMrseb0SPGXtYRnOPLlhSniufPII65RSZ3y+j8nWga+RANKAIy/9ttRHa8l6cLv4KgPwXDoCcenp5AYA8KlG6txFatMLqyoVJAYLaCG0NL3a00Hiu3JQAILcAUK8ZSrIj00ZoAVBVOUsq9AM1Yr9xEStDZaYnthFaAFRTo7s15KceHQDUgv22xVERdxOqu8RosRsM2wgtAKqqHqDpPYYAqAn7jUsDSG4AQG3Zb1xqLU5tEwBqyn7rAkCN229dssVlLKcIgJqx37wAUNv221fflAdALdrfgBwAoSe6CfsbkOWpCJwfANSC/Q3IARCKsCbsb0Bq/AI5UIv2NyCW10wAwnSORuxvQNYirMANT22EFgDVFxm6n9+r52QAoEbsb0HaHA4BEMmvQdNWQguAFtAYoFLLJbYRWgC0gIZZQANABazmmyggALSE+uEMXnsmJWpArYQWAC2iYSoisa0jnWYz30QBAaBl1BNUbsWSNkILgBaSnA9dcMWbNkILgBaSetpBQYvlTGUIAG1WbYQWAG1WbYQWAG1WbYQWAG1WbYQWAG1WbYQWAG1WbYQWAG1WbYQWAG1WbYQWAG1WbYQWAG1WbYQWAG1WbYS2OkBQNVVOujC14YVTRd0re60tW1tQjTsOgFpX444DoNbVuOMAqHU17jgAal2bdRxqQwAIyhIAgrIEgKAsASAoSwAIyhIAgrLUKkCPX7ymTy8JuaT0TMhtvjF6z83kGxPWKD1dl7PW+fbsdQlry6tRgB5vuoCeLjuGbh9f3D188jrb2PmSpVW+MWGN0oera1rK2tMr9pz0AtZWUJsAPf3pB/Ez737nD5+9FQHONtYBlG1MWXt69YdrWsqa4Cbf2hpqE6C+nOje2CN87/OydmHs1BUQBYwJa6frrggrZe38wVVXVpewtrzaBqjL1UvEVdLYmSmV5F1uURAg+n9v6amIb8uraYAefnVXJGd/LFceSmsnNiOwmLVyvi2vlgESVYMSNdUvXsvcokRFdWiFlbLGfDsV8W15tQzQPf+ZF2zGF2x4F2/Gl7G2vFoFCNqIABCUJQAEZQkAQVkCQFCWABCUJQAEZQkAQVkCQFCWABCUJQAEZQkAQVkCQFCWABCUJQAEZQkAQVkCQFCWABCUpf8HFNm55iEl4WMAAAAASUVORK5CYII=" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co">#writeRaster(best,paste0(datadir,&quot;best_EVD.tif&quot;))</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co">#find where gev shape is significant, defined as (1 - p-value) × 100</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>mle_sig <span class="ot">=</span> <span class="fu">raster_se_sig</span>(<span class="fu">c</span>(gevns_r<span class="sc">$</span>shape,gevns_r<span class="sc">$</span>cov_16))</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>at <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>,<span class="fu">seq</span>(<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">5</span>))</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#where mle(par) +-1.95 se(par) is entirely on one side of zero&quot;</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>sp<span class="sc">::</span><span class="fu">spplot</span>(mle_sig,<span class="at">at=</span>at,<span class="at">col.regions =</span><span class="fu">rev</span>(<span class="fu">rwb</span>(<span class="dv">20</span>)),<span class="at">main =</span> <span class="st">&quot;Confidence Value For a GEV shape parameter in a non-stationary EVD&quot;</span>,</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>           <span class="at">sp.layout =</span> coast.layer)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co">#find where gev non-stationary location is significant, defined as (1 - p-value) × 100</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>mle_sig <span class="ot">=</span> <span class="fu">raster_se_sig</span>(<span class="fu">c</span>(gevns_r<span class="sc">$</span>locyear,gevns_r<span class="sc">$</span>cov_6))</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>at <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>,<span class="fu">seq</span>(<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">5</span>))</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#where mle(par) +-1.95 se(par) is entirely on one side of zero&quot;</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>sp<span class="sc">::</span><span class="fu">spplot</span>(mle_sig,<span class="at">at=</span>at,<span class="at">col.regions =</span><span class="fu">rev</span>(<span class="fu">rwb</span>(<span class="dv">14</span>)),<span class="at">main =</span> <span class="st">&quot;Confidence Value For a non-stationary covariate location (locyear) parameter&quot;</span>,</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>           <span class="at">sp.layout =</span> coast.layer)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>AEP_year <span class="ot">=</span> <span class="dv">1981</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>gevns_RL5pc_1981 <span class="ot">=</span> <span class="fu">raster_qevd</span>(<span class="at">x =</span> gev_r,<span class="at">p =</span> <span class="dv">1</span><span class="fl">-.05</span>, <span class="at">evd_mod_str =</span> <span class="st">&quot;fgev&quot;</span>) <span class="sc">+</span> nsloctab<span class="sc">$</span>year_cs[nsloctab<span class="sc">$</span>year<span class="sc">==</span>AEP_year]<span class="sc">*</span>gevns_r<span class="sc">$</span>locyear</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>AEP_year <span class="ot">=</span> <span class="dv">2019</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>gevns_RL5pc_2019 <span class="ot">=</span> <span class="fu">raster_qevd</span>(<span class="at">x =</span> gev_r,<span class="at">p =</span> <span class="dv">1</span><span class="fl">-.05</span>, <span class="at">evd_mod_str =</span> <span class="st">&quot;fgev&quot;</span>) <span class="sc">+</span> nsloctab<span class="sc">$</span>year_cs[nsloctab<span class="sc">$</span>year<span class="sc">==</span>AEP_year]<span class="sc">*</span>gevns_r<span class="sc">$</span>locyear</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>plotit <span class="ot">=</span> <span class="fu">c</span>(gevns_RL5pc_1981,gevns_RL5pc_2019)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="fu">names</span>(plotit) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;gevns_RL5pc_1981&quot;</span>,<span class="st">&quot;gevns_RL5pc_2019&quot;</span>)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>at<span class="ot">=</span><span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>,<span class="fu">seq</span>(<span class="fl">27.5</span>,<span class="dv">50</span>,<span class="fl">2.5</span>),<span class="cn">Inf</span>)</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>cp <span class="ot">=</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;light yellow&quot;</span>,<span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;brown4&quot;</span>))</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#pdf(&quot;../plots/Empirical_20_year_ARI_daily_max_temp.pdf&quot;)</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>sp<span class="sc">::</span><span class="fu">spplot</span>(plotit,<span class="at">at=</span>at,<span class="at">col.regions =</span><span class="fu">c</span>(<span class="st">&quot;#FFFFFF&quot;</span>,<span class="fu">cp</span>(<span class="dv">9</span>),<span class="st">&quot;#000000&quot;</span>),<span class="at">main=</span><span class="fu">paste0</span>(<span class="st">&quot;GEV_ns 5% AEP for the years 1981 and 2019&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>at <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>,<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>,.<span class="dv">5</span>),<span class="cn">Inf</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>sp<span class="sc">::</span><span class="fu">spplot</span>(gevns_RL5pc_2019<span class="sc">-</span>gevns_RL5pc_1981,<span class="at">at=</span>at,<span class="at">col.regions =</span><span class="fu">c</span>(<span class="st">&quot;#FFFFFF&quot;</span>,<span class="fu">rev</span>(<span class="fu">rwb</span>(<span class="dv">17</span>)),<span class="st">&quot;#000000&quot;</span>),<span class="at">main=</span><span class="fu">paste0</span>(<span class="st">&quot;Non-stationary change in 5% AEP GEV extremes 1981 to 2019&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>poi <span class="ot">=</span> <span class="fu">vect</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="fl">142.91964371685395</span>,<span class="sc">-</span><span class="fl">35.873803703002594</span>)) ,<span class="st">&quot;points&quot;</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#extract a time series for the point of interest</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="fu">crs</span>(poi) <span class="ot">=</span> <span class="fu">crs</span>(gevns_r)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="fu">crs</span>(r) <span class="ot">=</span> <span class="fu">crs</span>(poi)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>valz <span class="ot">=</span>  <span class="fu">as.numeric</span>(<span class="fu">extract</span>(r,poi,<span class="at">ID =</span> <span class="cn">FALSE</span>))</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>poi_ts <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">date =</span> <span class="fu">time</span>(r),<span class="at">annMax =</span> valz)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>gumbel_v <span class="ot">=</span> <span class="fu">extract</span>(gumbel_r,poi,<span class="at">xy=</span><span class="cn">FALSE</span>,<span class="at">ID=</span><span class="cn">FALSE</span>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>gumbel_v <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">sapply</span>(gumbel_v, <span class="cf">function</span>(x) x[[<span class="dv">1</span>]])))</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>gev_v <span class="ot">=</span> <span class="fu">extract</span>(gev_r,poi,<span class="at">xy=</span><span class="cn">FALSE</span>,<span class="at">ID=</span><span class="cn">FALSE</span>)</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>gev_v <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">sapply</span>(gev_v, <span class="cf">function</span>(x) x[[<span class="dv">1</span>]])))</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>gumbelx_v <span class="ot">=</span> <span class="fu">extract</span>(gumbelx_r,poi,<span class="at">xy=</span><span class="cn">FALSE</span>,<span class="at">ID=</span><span class="cn">FALSE</span>)</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>gumbelx_v <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">sapply</span>(gumbelx_v, <span class="cf">function</span>(x) x[[<span class="dv">1</span>]])))</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>gumbelns_v <span class="ot">=</span> <span class="fu">extract</span>(gumbelns_r,poi,<span class="at">xy=</span><span class="cn">FALSE</span>,<span class="at">ID=</span><span class="cn">FALSE</span>)</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>gumbelns_v <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">sapply</span>(gumbelns_v, <span class="cf">function</span>(x) x[[<span class="dv">1</span>]])))</span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>gevns_v <span class="ot">=</span> <span class="fu">extract</span>(gevns_r,poi,<span class="at">xy=</span><span class="cn">FALSE</span>,<span class="at">ID=</span><span class="cn">FALSE</span>)</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>gevns_v <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">sapply</span>(gevns_v, <span class="cf">function</span>(x) x[[<span class="dv">1</span>]])))</span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a>gevns_63AEP <span class="ot">=</span> <span class="fu">df_qevd</span>(<span class="at">x =</span> gev_v,<span class="at">p =</span> <span class="dv">1</span><span class="fl">-0.63</span>,<span class="at">evd_mod_str =</span> <span class="st">&quot;fgev&quot;</span>) <span class="sc">+</span> nsloctab<span class="sc">$</span>year_cs<span class="sc">*</span>gevns_v<span class="sc">$</span>locyear</span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>gevns_05AEP <span class="ot">=</span> <span class="fu">df_qevd</span>(<span class="at">x =</span> gev_v,<span class="at">p =</span> <span class="dv">1</span><span class="fl">-0.05</span>,<span class="at">evd_mod_str =</span> <span class="st">&quot;fgev&quot;</span>) <span class="sc">+</span> nsloctab<span class="sc">$</span>year_cs<span class="sc">*</span>gevns_v<span class="sc">$</span>locyear</span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a>gevns_01AEP <span class="ot">=</span> <span class="fu">df_qevd</span>(<span class="at">x =</span> gev_v,<span class="at">p =</span> <span class="dv">1</span><span class="fl">-0.01</span>,<span class="at">evd_mod_str =</span> <span class="st">&quot;fgev&quot;</span>) <span class="sc">+</span> nsloctab<span class="sc">$</span>year_cs<span class="sc">*</span>gevns_v<span class="sc">$</span>locyear</span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a>YLIM <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">min</span>(poi_ts<span class="sc">$</span>annMax),<span class="fu">max</span>(gevns_01AEP))</span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a><span class="fu">plot</span>(r_years,valz,<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">main =</span> <span class="st">&quot;Non stationary EVD&quot;</span>,<span class="at">ylim =</span> YLIM);<span class="fu">grid</span>()</span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a></span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a>poi_ts<span class="sc">$</span>annMaxns <span class="ot">=</span> poi_ts<span class="sc">$</span>annMax<span class="sc">-</span>nsloctab<span class="sc">$</span>year_cs<span class="sc">*</span>gevns_v<span class="sc">$</span>locyear</span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a><span class="fu">lines</span>(r_years,poi_ts<span class="sc">$</span>annMaxns,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a></span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a><span class="fu">lines</span>(r_years,gevns_63AEP,<span class="at">col =</span> <span class="dv">4</span>)</span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a><span class="fu">lines</span>(r_years,gevns_05AEP,<span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a><span class="fu">lines</span>(r_years,gevns_01AEP,<span class="at">col =</span> <span class="dv">6</span>)</span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a></span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;1% AEP&quot;</span>,<span class="st">&quot;5% AEP&quot;</span>,<span class="st">&quot;63% AEP&quot;</span>,<span class="st">&quot;AnnMax&quot;</span>,<span class="st">&quot;AnnMax_stat&quot;</span>),<span class="at">col =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="st">&quot;grey&quot;</span>),<span class="at">lty=</span><span class="dv">1</span>,<span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>ndat <span class="ot">=</span> <span class="fu">length</span>(poi_ts<span class="sc">$</span>annMax)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>empi_AEP <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">log</span>((<span class="dv">1</span><span class="sc">:</span>ndat)<span class="sc">/</span>(ndat <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>AEP <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>empi_AEP)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>gumbel_RL <span class="ot">=</span> <span class="fu">qevd_vector</span>(<span class="at">x =</span> gumbel_v,<span class="at">p =</span> <span class="dv">1</span><span class="sc">-</span>AEP,<span class="at">evd_mod_str =</span> <span class="st">&quot;fgumbel&quot;</span>)</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>gev_RL <span class="ot">=</span> <span class="fu">qevd_vector</span>(<span class="at">x =</span> gev_v,<span class="at">p =</span> <span class="dv">1</span><span class="sc">-</span>AEP,<span class="at">evd_mod_str =</span> <span class="st">&quot;fgev&quot;</span>)</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>gumbelns_RL <span class="ot">=</span> <span class="fu">qevd_vector</span>(<span class="at">x =</span> gumbelns_v,<span class="at">p =</span> <span class="dv">1</span><span class="sc">-</span>AEP,<span class="at">evd_mod_str =</span> <span class="st">&quot;fgumbel&quot;</span>)</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>gevns_RL <span class="ot">=</span> <span class="fu">qevd_vector</span>(<span class="at">x =</span> gevns_v,<span class="at">p =</span> <span class="dv">1</span><span class="sc">-</span>AEP,<span class="at">evd_mod_str =</span> <span class="st">&quot;fgev&quot;</span>)</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>gumbelx_RL <span class="ot">=</span> <span class="fu">qevd_vector</span>(<span class="at">x =</span> gumbelx_v,<span class="at">p =</span> <span class="dv">1</span><span class="sc">-</span>AEP,<span class="at">evd_mod_str =</span> <span class="st">&quot;fgumbelx&quot;</span>,<span class="at">interval =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>))</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="fu">plot_empirical</span>(<span class="at">x=</span>poi_ts<span class="sc">$</span>annMax,<span class="at">xns =</span> poi_ts<span class="sc">$</span>annMaxns)</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="fu">lines</span>(empi_AEP,gumbel_RL)</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="fu">lines</span>(empi_AEP,gev_RL,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#lines(empi_AEP,gumbelx_RL,col=&quot;green&quot;)</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="fu">lines</span>(empi_AEP,gumbelns_RL,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="fu">lines</span>(empi_AEP,gevns_RL,<span class="at">col=</span><span class="st">&quot;yellow&quot;</span>)</span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#legend(&#39;topleft&#39;,legend = paste0(c(&quot;fgumbelx&quot;,&quot;fgev&quot;,&quot;fgumbel&quot;,&quot;fgumbelns&quot;),rep(&quot; AIC = &quot;,4),round(as.numeric(c(rev(gumbelx)[1],rev(gev)[1],rev(gumbel)[1],rev(gumbelns)[1])),1)),col = c(4,2,1,&quot;grey&quot;),lty = 1)</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a> <span class="fu">legend</span>(<span class="st">&#39;bottomright&#39;</span>,<span class="at">legend =</span> <span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">&quot;fgev&quot;</span>,<span class="st">&quot;fgumbel&quot;</span>,<span class="st">&quot;fgumbelns&quot;</span>,<span class="st">&quot;fgevns&quot;</span>),<span class="fu">rep</span>(<span class="st">&quot; AIC = &quot;</span>,<span class="dv">4</span>),<span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rev</span>(gev_v)[<span class="dv">1</span>],<span class="fu">rev</span>(gumbel_v)[<span class="dv">1</span>],<span class="fu">rev</span>(gumbelns_v)[<span class="dv">1</span>],<span class="fu">rev</span>(gevns_v)[<span class="dv">1</span>])),<span class="dv">1</span>)),<span class="at">col =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="st">&quot;grey&quot;</span>,<span class="st">&quot;yellow&quot;</span>),<span class="at">lty =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># = terra::rast(system.file(&quot;extdata/50km_AnnMax_agcd_v1_precip_calib_r005_daily_1980-2019.nc&quot;,package = &quot;loopevd&quot;))</span></span></code></pre></div>
<div id="troubleshooting-and-common-pitfalls" class="section level2">
<h2>Troubleshooting and Common Pitfalls</h2>
<ul>
<li><strong>Fitting fails at some pixels</strong>: This can happen with
short or noisy time series. Try reducing the model complexity or using
more robust data filtering.</li>
<li><strong>Output NA values</strong>: Check data completeness or
whether a return level is outside the support of the fitted
distribution.</li>
<li><strong>Parallel cores not being used</strong>: Make sure your R
session supports parallel processing and that <code>terra::app()</code>
is not silently defaulting to single-core.</li>
</ul>
</div>
<div id="what-next" class="section level2">
<h2>What Next?</h2>
<ul>
<li>Explore the package reference:
<code>help(package = &quot;loopevd&quot;)</code></li>
<li>Try fitting with other covariates like ENSO or SAM that are
commented out in the above code.</li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
